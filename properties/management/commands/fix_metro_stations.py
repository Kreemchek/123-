# fix_metro_stations.py
from properties.models import MetroStation
from django.contrib.gis.geos import Point


def update_or_create_station(city, name, line, line_color, lon, lat):
    """–°–æ–∑–¥–∞–µ—Ç –∏–ª–∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç —Å—Ç–∞–Ω—Ü–∏—é –º–µ—Ç—Ä–æ"""
    try:
        obj, created = MetroStation.objects.update_or_create(
            city=city,
            name=name,
            defaults={
                'line': line,
                'line_color': line_color,
                'coordinates': Point(lon, lat, srid=4326)
            }
        )
        return obj, created
    except Exception as e:
        print(f"‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —Å—Ç–∞–Ω—Ü–∏–∏ {name}: {e}")
        return None, False


def add_mck_stations():
    """–î–æ–±–∞–≤–ª—è–µ—Ç —Å—Ç–∞–Ω—Ü–∏–∏ –ú–¶–ö"""
    print("üöá –î–û–ë–ê–í–õ–Ø–ï–ú –°–¢–ê–ù–¶–ò–ò –ú–¶–ö")
    print("=" * 40)

    mck_stations = {
        '–ú–¶–ö': [
            ('–ë–æ—Ç–∞–Ω–∏—á–µ—Å–∫–∏–π —Å–∞–¥', 37.638, 55.845, '#8B4513'),
            ('–í–ª–∞–¥—ã–∫–∏–Ω–æ', 37.589, 55.847, '#8B4513'),
            ('–û–∫—Ä—É–∂–Ω–∞—è', 37.574, 55.847, '#8B4513'),
            ('–õ–∏—Ö–æ–±–æ—Ä—ã', 37.562, 55.847, '#8B4513'),
            ('–ö–æ–ø—Ç–µ–≤–æ', 37.524, 55.840, '#8B4513'),
            ('–ë–∞–ª—Ç–∏–π—Å–∫–∞—è', 37.496, 55.826, '#8B4513'),
            ('–°—Ç—Ä–µ—à–Ω–µ–≤–æ', 37.487, 55.814, '#8B4513'),
            ('–ü–∞–Ω—Ñ–∏–ª–æ–≤—Å–∫–∞—è', 37.504, 55.800, '#8B4513'),
            ('–ó–æ—Ä–≥–µ', 37.520, 55.789, '#8B4513'),
            ('–•–æ—Ä–æ—à—ë–≤–æ', 37.516, 55.777, '#8B4513'),
            ('–®–µ–ª–µ–ø–∏—Ö–∞', 37.531, 55.757, '#8B4513'),
            ('–î–µ–ª–æ–≤–æ–π —Ü–µ–Ω—Ç—Ä', 37.532, 55.749, '#8B4513'),
            ('–ö—É—Ç—É–∑–æ–≤—Å–∫–∞—è', 37.534, 55.741, '#8B4513'),
            ('–õ—É–∂–Ω–∏–∫–∏', 37.560, 55.720, '#8B4513'),
            ('–ü–ª–æ—â–∞–¥—å –ì–∞–≥–∞—Ä–∏–Ω–∞', 37.586, 55.707, '#8B4513'),
            ('–ö—Ä—ã–º—Å–∫–∞—è', 37.605, 55.690, '#8B4513'),
            ('–í–µ—Ä—Ö–Ω–∏–µ –ö–æ—Ç–ª—ã', 37.618, 55.690, '#8B4513'),
            ('–ó–ò–õ', 37.647, 55.685, '#8B4513'),
            ('–ê–≤—Ç–æ–∑–∞–≤–æ–¥—Å–∫–∞—è', 37.663, 55.708, '#8B4513'),
            ('–î—É–±—Ä–æ–≤–∫–∞', 37.676, 55.718, '#8B4513'),
            ('–£–≥—Ä–µ—à—Å–∫–∞—è', 37.683, 55.718, '#8B4513'),
            ('–ù–æ–≤–æ—Ö–æ—Ö–ª–æ–≤—Å–∫–∞—è', 37.716, 55.724, '#8B4513'),
            ('–ù–∏–∂–µ–≥–æ—Ä–æ–¥—Å–∫–∞—è', 37.728, 55.732, '#8B4513'),
            ('–ê–Ω–¥—Ä–æ–Ω–æ–≤–∫–∞', 37.740, 55.740, '#8B4513'),
            ('–°–æ–∫–æ–ª–∏–Ω–∞—è –ì–æ—Ä–∞', 37.745, 55.773, '#8B4513'),
            ('–®–æ—Å—Å–µ –≠–Ω—Ç—É–∑–∏–∞—Å—Ç–æ–≤', 37.751, 55.758, '#8B4513'),
            ('–õ–æ–∫–æ–º–æ—Ç–∏–≤', 37.745, 55.804, '#8B4513'),
            ('–ò–∑–º–∞–π–ª–æ–≤–æ', 37.742, 55.788, '#8B4513'),
            ('–°–æ–∫–æ–ª—å–Ω–∏—á–µ—Å–∫–∞—è', 37.679, 55.788, '#8B4513'),
            ('–†–æ—Å—Ç–æ–∫–∏–Ω–æ', 37.667, 55.837, '#8B4513'),
            ('–ë–µ–ª–æ–∫–∞–º–µ–Ω–Ω–∞—è', 37.658, 55.829, '#8B4513')
        ]
    }

    added_count = 0
    for line, stations_data in mck_stations.items():
        for station_name, lon, lat, color in stations_data:
            obj, created = update_or_create_station('–ú–æ—Å–∫–≤–∞', station_name, line, color, lon, lat)
            if created:
                added_count += 1
                print(f"‚úÖ {station_name}")

    print(f"üéØ –î–æ–±–∞–≤–ª–µ–Ω–æ —Å—Ç–∞–Ω—Ü–∏–π –ú–¶–ö: {added_count}")
    return added_count


def add_mcd1_stations():
    """–î–æ–±–∞–≤–ª—è–µ—Ç —Å—Ç–∞–Ω—Ü–∏–∏ –ú–¶–î-1"""
    print("\nüöÜ –î–û–ë–ê–í–õ–Ø–ï–ú –°–¢–ê–ù–¶–ò–ò –ú–¶–î-1")
    print("=" * 40)

    mcd1_stations = {
        '–ú–¶–î-1': [
            ('–û–¥–∏–Ω—Ü–æ–≤–æ', 37.275, 55.678, '#DAA520'),
            ('–ë–∞–∫–æ–≤–∫–∞', 37.350, 55.693, '#DAA520'),
            ('–°–∫–æ–ª–∫–æ–≤–æ', 37.370, 55.698, '#DAA520'),
            ('–ù–µ–º—á–∏–Ω–æ–≤–∫–∞', 37.380, 55.715, '#DAA520'),
            ('–°–µ—Ç—É–Ω—å', 37.410, 55.725, '#DAA520'),
            ('–†–∞–±–æ—á–∏–π –ü–æ—Å—ë–ª–æ–∫', 37.430, 55.735, '#DAA520'),
            ('–ö—É–Ω—Ü–µ–≤–æ', 37.395, 55.731, '#DAA520'),
            ('–§–∏–ª–∏', 37.514, 55.746, '#DAA520'),
            ('–¢–µ—Å—Ç–æ–≤—Å–∫–∞—è', 37.532, 55.749, '#DAA520'),
            ('–ë–µ–ª–æ—Ä—É—Å—Å–∫–∞—è', 37.581, 55.777, '#DAA520'),
            ('–°–∞–≤—ë–ª–æ–≤—Å–∫–∞—è', 37.588, 55.793, '#DAA520'),
            ('–û–∫—Ä—É–∂–Ω–∞—è', 37.574, 55.847, '#DAA520'),
            ('–î–µ–≥—É–Ω–∏–Ω–æ', 37.550, 55.866, '#DAA520'),
            ('–ë–µ—Å–∫—É–¥–Ω–∏–∫–æ–≤–æ', 37.560, 55.883, '#DAA520'),
            ('–õ–∏–∞–Ω–æ–∑–æ–≤–æ', 37.570, 55.897, '#DAA520'),
            ('–ú–∞—Ä–∫', 37.580, 55.910, '#DAA520'),
            ('–ù–æ–≤–æ–¥–∞—á–Ω–∞—è', 37.590, 55.925, '#DAA520'),
            ('–î–æ–ª–≥–æ–ø—Ä—É–¥–Ω–∞—è', 37.600, 55.940, '#DAA520'),
            ('–í–æ–¥–Ω–∏–∫–∏', 37.610, 55.955, '#DAA520'),
            ('–•–ª–µ–±–Ω–∏–∫–æ–≤–æ', 37.620, 55.970, '#DAA520'),
            ('–®–µ—Ä–µ–º–µ—Ç—å–µ–≤—Å–∫–∞—è', 37.630, 55.985, '#DAA520'),
            ('–õ–æ–±–Ω—è', 37.640, 56.000, '#DAA520')
        ]
    }

    added_count = 0
    for line, stations_data in mcd1_stations.items():
        for station_name, lon, lat, color in stations_data:
            obj, created = update_or_create_station('–ú–æ—Å–∫–≤–∞', station_name, line, color, lon, lat)
            if created:
                added_count += 1
                print(f"‚úÖ {station_name}")

    print(f"üéØ –î–æ–±–∞–≤–ª–µ–Ω–æ —Å—Ç–∞–Ω—Ü–∏–π –ú–¶–î-1: {added_count}")
    return added_count


def add_mcd2_stations():
    """–î–æ–±–∞–≤–ª—è–µ—Ç —Å—Ç–∞–Ω—Ü–∏–∏ –ú–¶–î-2"""
    print("\nüöÜ –î–û–ë–ê–í–õ–Ø–ï–ú –°–¢–ê–ù–¶–ò–ò –ú–¶–î-2")
    print("=" * 40)

    mcd2_stations = {
        '–ú–¶–î-2': [
            ('–ù–∞—Ö–∞–±–∏–Ω–æ', 37.175, 55.848, '#FF00FF'),
            ('–ê–Ω–∏–∫–µ–µ–≤–∫–∞', 37.200, 55.830, '#FF00FF'),
            ('–û–ø–∞–ª–∏—Ö–∞', 37.250, 55.820, '#FF00FF'),
            ('–ö—Ä–∞—Å–Ω–æ–≥–æ—Ä—Å–∫–∞—è', 37.300, 55.815, '#FF00FF'),
            ('–ü–∞–≤—à–∏–Ω–æ', 37.350, 55.810, '#FF00FF'),
            ('–ü–µ–Ω—è–≥–∏–Ω–æ', 37.370, 55.805, '#FF00FF'),
            ('–¢—Ä–∏–∫–æ—Ç–∞–∂–Ω–∞—è', 37.390, 55.800, '#FF00FF'),
            ('–¢—É—à–∏–Ω—Å–∫–∞—è', 37.436, 55.827, '#FF00FF'),
            ('–©—É–∫–∏–Ω—Å–∫–∞—è', 37.462, 55.807, '#FF00FF'),
            ('–°—Ç—Ä–µ—à–Ω–µ–≤–æ', 37.487, 55.814, '#FF00FF'),
            ('–ö—Ä–∞—Å–Ω—ã–π –ë–∞–ª—Ç–∏–µ—Ü', 37.496, 55.826, '#FF00FF'),
            ('–ì—Ä–∞–∂–¥–∞–Ω—Å–∫–∞—è', 37.510, 55.806, '#FF00FF'),
            ('–î–º–∏—Ç—Ä–æ–≤—Å–∫–∞—è', 37.581, 55.807, '#FF00FF'),
            ('–†–∏–∂—Å–∫–∞—è', 37.636, 55.793, '#FF00FF'),
            ('–ö—É—Ä—Å–∫–∞—è', 37.659, 55.758, '#FF00FF'),
            ('–ú–æ—Å–∫–≤–∞-–¢–æ–≤–∞—Ä–Ω–∞—è', 37.665, 55.745, '#FF00FF'),
            ('–ö–∞–ª–∏—Ç–Ω–∏–∫–∏', 37.700, 55.733, '#FF00FF'),
            ('–ù–æ–≤–æ—Ö–æ—Ö–ª–æ–≤—Å–∫–∞—è', 37.716, 55.724, '#FF00FF'),
            ('–¢–µ–∫—Å—Ç–∏–ª—å—â–∏–∫–∏', 37.732, 55.708, '#FF00FF'),
            ('–ö—É–±–∞–Ω—Å–∫–∞—è', 37.745, 55.690, '#FF00FF'),
            ('–î–µ–ø–æ', 37.755, 55.675, '#FF00FF'),
            ('–ü–µ—Ä–µ—Ä–≤–∞', 37.765, 55.660, '#FF00FF'),
            ('–ú–æ—Å–∫–≤–æ—Ä–µ—á—å–µ', 37.775, 55.645, '#FF00FF'),
            ('–¶–∞—Ä–∏—Ü—ã–Ω–æ', 37.669, 55.621, '#FF00FF'),
            ('–ü–æ–∫—Ä–æ–≤—Å–∫–æ–µ', 37.680, 55.610, '#FF00FF'),
            ('–ö—Ä–∞—Å–Ω—ã–π –°—Ç—Ä–æ–∏—Ç–µ–ª—å', 37.690, 55.600, '#FF00FF'),
            ('–ë–∏—Ç—Ü–∞', 37.700, 55.590, '#FF00FF'),
            ('–ë—É—Ç–æ–≤–æ', 37.710, 55.580, '#FF00FF'),
            ('–©–µ—Ä–±–∏–Ω–∫–∞', 37.720, 55.570, '#FF00FF'),
            ('–û—Å—Ç–∞—Ñ—å–µ–≤–æ', 37.730, 55.560, '#FF00FF'),
            ('–°–∏–ª–∏–∫–∞—Ç–Ω–∞—è', 37.740, 55.550, '#FF00FF'),
            ('–ü–æ–¥–æ–ª—å—Å–∫', 37.750, 55.540, '#FF00FF')
        ]
    }

    added_count = 0
    for line, stations_data in mcd2_stations.items():
        for station_name, lon, lat, color in stations_data:
            obj, created = update_or_create_station('–ú–æ—Å–∫–≤–∞', station_name, line, color, lon, lat)
            if created:
                added_count += 1
                print(f"‚úÖ {station_name}")

    print(f"üéØ –î–æ–±–∞–≤–ª–µ–Ω–æ —Å—Ç–∞–Ω—Ü–∏–π –ú–¶–î-2: {added_count}")
    return added_count


def add_mcd3_stations():
    """–î–æ–±–∞–≤–ª—è–µ—Ç —Å—Ç–∞–Ω—Ü–∏–∏ –ú–¶–î-3"""
    print("\nüöÜ –î–û–ë–ê–í–õ–Ø–ï–ú –°–¢–ê–ù–¶–ò–ò –ú–¶–î-3")
    print("=" * 40)

    mcd3_stations = {
        '–ú–¶–î-3': [
            ('–ó–µ–ª–µ–Ω–æ–≥—Ä–∞–¥-–ö—Ä—é–∫–æ–≤–æ', 37.200, 56.010, '#FFEFD5'),
            ('–§–∏—Ä—Å–∞–Ω–æ–≤—Å–∫–∞—è', 37.240, 55.950, '#FFEFD5'),
            ('–°—Ö–æ–¥–Ω—è', 37.280, 55.950, '#FFEFD5'),
            ('–ü–æ–¥—Ä–µ–∑–∫–æ–≤–æ', 37.320, 55.940, '#FFEFD5'),
            ('–ù–æ–≤–æ–ø–æ–¥—Ä–µ–∑–∫–æ–≤–æ', 37.360, 55.940, '#FFEFD5'),
            ('–ú–æ–ª–∂–∞–Ω–∏–Ω–æ–≤–æ', 37.400, 55.930, '#FFEFD5'),
            ('–•–∏–º–∫–∏', 37.450, 55.890, '#FFEFD5'),
            ('–õ–µ–≤–æ–±–µ—Ä–µ–∂–Ω–∞—è', 37.480, 55.880, '#FFEFD5'),
            ('–•–æ–≤—Ä–∏–Ω–æ', 37.510, 55.870, '#FFEFD5'),
            ('–ì—Ä–∞—á—ë–≤—Å–∫–∞—è', 37.550, 55.850, '#FFEFD5'),
            ('–ú–æ—Å—Å–µ–ª—å–º–∞—à', 37.580, 55.830, '#FFEFD5'),
            ('–õ–∏—Ö–æ–±–æ—Ä—ã', 37.562, 55.847, '#FFEFD5'),
            ('–ü–µ—Ç—Ä–æ–≤—Å–∫–æ-–†–∞–∑—É–º–æ–≤—Å–∫–∞—è', 37.574, 55.837, '#FFEFD5'),
            ('–û—Å—Ç–∞–Ω–∫–∏–Ω–æ', 37.610, 55.820, '#FFEFD5'),
            ('–†–∏–∂—Å–∫–∞—è', 37.636, 55.793, '#FFEFD5'),
            ('–ú–∏—Ç—å–∫–æ–≤–æ', 37.660, 55.800, '#FFEFD5'),
            ('–≠–ª–µ–∫—Ç—Ä–æ–∑–∞–≤–æ–¥—Å–∫–∞—è', 37.705, 55.782, '#FFEFD5'),
            ('–°–æ—Ä—Ç–∏—Ä–æ–≤–æ—á–Ω–∞—è', 37.730, 55.770, '#FFEFD5'),
            ('–ê–≤–∏–∞–º–æ—Ç–æ—Ä–Ω–∞—è', 37.720, 55.752, '#FFEFD5'),
            ('–ù–æ–≤–æ—Ö–æ—Ö–ª–æ–≤—Å–∫–∞—è', 37.716, 55.724, '#FFEFD5'),
            ('–£–≥—Ä–µ—à—Å–∫–∞—è', 37.683, 55.718, '#FFEFD5'),
            ('–î—É–±—Ä–æ–≤–∫–∞', 37.676, 55.718, '#FFEFD5'),
            ('–ö–æ–∂—É—Ö–æ–≤–æ', 37.670, 55.700, '#FFEFD5'),
            ('–ü–ª—é—â–µ–≤–æ', 37.680, 55.680, '#FFEFD5'),
            ('–í–µ—à–Ω—è–∫–∏', 37.790, 55.715, '#FFEFD5'),
            ('–í—ã—Ö–∏–Ω–æ', 37.817, 55.715, '#FFEFD5'),
            ('–ö–æ—Å–∏–Ω–æ', 37.857, 55.705, '#FFEFD5'),
            ('–£—Ö—Ç–æ–º—Å–∫–∞—è', 37.850, 55.690, '#FFEFD5'),
            ('–õ—é–±–µ—Ä—Ü—ã', 37.860, 55.680, '#FFEFD5'),
            ('–ü–∞–Ω–∫–∏', 37.870, 55.670, '#FFEFD5'),
            ('–¢–æ–º–∏–ª–∏–Ω–æ', 37.880, 55.660, '#FFEFD5'),
            ('–ö—Ä–∞—Å–∫–æ–≤–æ', 37.890, 55.650, '#FFEFD5'),
            ('–ú–∞–ª–∞—Ö–æ–≤–∫–∞', 37.900, 55.640, '#FFEFD5'),
            ('–£–¥–µ–ª—å–Ω–∞—è', 37.920, 55.620, '#FFEFD5'),
            ('–ë—ã–∫–æ–≤–æ', 37.930, 55.610, '#FFEFD5'),
            ('–ò–ª—å–∏–Ω—Å–∫–∞—è', 37.940, 55.600, '#FFEFD5'),
            ('–û—Ç–¥—ã—Ö', 37.950, 55.590, '#FFEFD5'),
            ('–ö—Ä–∞—Ç–æ–≤–æ', 37.960, 55.580, '#FFEFD5')
        ]
    }

    added_count = 0
    for line, stations_data in mcd3_stations.items():
        for station_name, lon, lat, color in stations_data:
            obj, created = update_or_create_station('–ú–æ—Å–∫–≤–∞', station_name, line, color, lon, lat)
            if created:
                added_count += 1
                print(f"‚úÖ {station_name}")

    print(f"üéØ –î–æ–±–∞–≤–ª–µ–Ω–æ —Å—Ç–∞–Ω—Ü–∏–π –ú–¶–î-3: {added_count}")
    return added_count


def add_mcd4_stations():
    """–î–æ–±–∞–≤–ª—è–µ—Ç —Å—Ç–∞–Ω—Ü–∏–∏ –ú–¶–î-4"""
    print("\nüöÜ –î–û–ë–ê–í–õ–Ø–ï–ú –°–¢–ê–ù–¶–ò–ò –ú–¶–î-4")
    print("=" * 40)

    mcd4_stations = {
        '–ú–¶–î-4': [
            ('–ê–ø—Ä–µ–ª–µ–≤–∫–∞', 37.080, 55.552, '#98FF98'),
            ('–ö—Ä—ë–∫—à–∏–Ω–æ', 37.150, 55.600, '#98FF98'),
            ('–°–∞–Ω–∞—Ç–æ—Ä–Ω–∞—è', 37.200, 55.630, '#98FF98'),
            ('–ö–æ–∫–æ—à–∫–∏–Ω–æ', 37.170, 55.597, '#98FF98'),
            ('–¢–æ–ª—Å—Ç–æ–ø–∞–ª—å—Ü–µ–≤–æ', 37.190, 55.610, '#98FF98'),
            ('–ü–æ–±–µ–¥–∞', 37.350, 55.630, '#98FF98'),
            ('–ú–æ—Å–∫–≤–∏—á', 37.400, 55.640, '#98FF98'),
            ('–°—Ç–æ–ª–±–æ–≤–æ', 37.320, 55.625, '#98FF98'),
            ('–õ–µ—Å–Ω–æ–π –ì–æ—Ä–æ–¥–æ–∫', 37.210, 55.638, '#98FF98'),
            ('–ü–µ—Ä–µ–¥–µ–ª–∫–∏–Ω–æ', 37.340, 55.657, '#98FF98'),
            ('–ú–∏—á—É—Ä–∏–Ω–µ—Ü', 37.480, 55.680, '#98FF98'),
            ('–í–Ω—É–∫–æ–≤–æ', 37.285, 55.615, '#98FF98'),
            ('–ü—ã—Ö—Ç–∏–Ω–æ', 37.300, 55.620, '#98FF98'),
            ('–ê—ç—Ä–æ–ø–æ—Ä—Ç –í–Ω—É–∫–æ–≤–æ', 37.270, 55.610, '#98FF98'),
            ('–ú–∞—Ç–≤–µ–µ–≤—Å–∫–∞—è', 37.483, 55.707, '#98FF98'),
            ('–ê–º–∏–Ω—å–µ–≤—Å–∫–∞—è', 37.500, 55.697, '#98FF98'),
            ('–ú–∏–Ω—Å–∫–∞—è', 37.497, 55.723, '#98FF98'),
            ('–õ—É–∂–Ω–∏–∫–∏', 37.560, 55.720, '#98FF98'),
            ('–ü–ª–æ—â–∞–¥—å –ì–∞–≥–∞—Ä–∏–Ω–∞', 37.586, 55.707, '#98FF98'),
            ('–ö—Ä—ã–º—Å–∫–∞—è', 37.605, 55.690, '#98FF98'),
            ('–í–µ—Ä—Ö–Ω–∏–µ –ö–æ—Ç–ª—ã', 37.618, 55.690, '#98FF98'),
            ('–ö—É–Ω—Ü–µ–≤–æ', 37.395, 55.731, '#98FF98'),
            ('–†–∞–±–æ—á–∏–π –ü–æ—Å—ë–ª–æ–∫', 37.430, 55.735, '#98FF98'),
            ('–°–µ—Ç—É–Ω—å', 37.410, 55.725, '#98FF98'),
            ('–ù–µ–º—á–∏–Ω–æ–≤–∫–∞', 37.380, 55.715, '#98FF98'),
            ('–°–∫–æ–ª–∫–æ–≤–æ', 37.370, 55.698, '#98FF98'),
            ('–ë–∞–∫–æ–≤–∫–∞', 37.350, 55.693, '#98FF98'),
            ('–û–¥–∏–Ω—Ü–æ–≤–æ', 37.275, 55.678, '#98FF98')
        ]
    }

    added_count = 0
    for line, stations_data in mcd4_stations.items():
        for station_name, lon, lat, color in stations_data:
            obj, created = update_or_create_station('–ú–æ—Å–∫–≤–∞', station_name, line, color, lon, lat)
            if created:
                added_count += 1
                print(f"‚úÖ {station_name}")

    print(f"üéØ –î–æ–±–∞–≤–ª–µ–Ω–æ —Å—Ç–∞–Ω—Ü–∏–π –ú–¶–î-4: {added_count}")
    return added_count


def show_final_stats():
    """–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ñ–∏–Ω–∞–ª—å–Ω—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É"""
    print("\nüìä –§–ò–ù–ê–õ–¨–ù–ê–Ø –°–¢–ê–¢–ò–°–¢–ò–ö–ê")
    print("=" * 50)

    lines = {
        '–ú–¶–ö': 31,
        '–ú–¶–î-1': 22,
        '–ú–¶–î-2': 32,
        '–ú–¶–î-3': 37,
        '–ú–¶–î-4': 28
    }

    for line, expected in lines.items():
        actual = MetroStation.objects.filter(city='–ú–æ—Å–∫–≤–∞', line=line).count()
        status = "‚úÖ" if actual == expected else "‚ùå"
        print(f"{status} {line}: {actual}/{expected}")

    total_mcd_mck = sum([MetroStation.objects.filter(city='–ú–æ—Å–∫–≤–∞', line=line).count() for line in lines.keys()])
    classic_metro = MetroStation.objects.filter(
        city='–ú–æ—Å–∫–≤–∞',
        line__in=[
            '–°–æ–∫–æ–ª—å–Ω–∏—á–µ—Å–∫–∞—è –ª–∏–Ω–∏—è', '–ó–∞–º–æ—Å–∫–≤–æ—Ä–µ—Ü–∫–∞—è –ª–∏–Ω–∏—è', '–ê—Ä–±–∞—Ç—Å–∫–æ-–ü–æ–∫—Ä–æ–≤—Å–∫–∞—è –ª–∏–Ω–∏—è',
            '–§–∏–ª—ë–≤—Å–∫–∞—è –ª–∏–Ω–∏—è', '–ö–æ–ª—å—Ü–µ–≤–∞—è –ª–∏–Ω–∏—è', '–ö–∞–ª—É–∂—Å–∫–æ-–†–∏–∂—Å–∫–∞—è –ª–∏–Ω–∏—è',
            '–¢–∞–≥–∞–Ω—Å–∫–æ-–ö—Ä–∞—Å–Ω–æ–ø—Ä–µ—Å–Ω–µ–Ω—Å–∫–∞—è –ª–∏–Ω–∏—è', '–ö–∞–ª–∏–Ω–∏–Ω—Å–∫–æ-–°–æ–ª–Ω—Ü–µ–≤—Å–∫–∞—è –ª–∏–Ω–∏—è',
            '–°–µ—Ä–ø—É—Ö–æ–≤—Å–∫–æ-–¢–∏–º–∏—Ä—è–∑–µ–≤—Å–∫–∞—è –ª–∏–Ω–∏—è', '–õ—é–±–ª–∏–Ω—Å–∫–æ-–î–º–∏—Ç—Ä–æ–≤—Å–∫–∞—è –ª–∏–Ω–∏—è',
            '–ë–æ–ª—å—à–∞—è –∫–æ–ª—å—Ü–µ–≤–∞—è –ª–∏–Ω–∏—è', '–ù–µ–∫—Ä–∞—Å–æ–≤—Å–∫–∞—è –ª–∏–Ω–∏—è', '–ë—É—Ç–æ–≤—Å–∫–∞—è –ª–∏–Ω–∏—è'
        ]
    ).count()

    total_all = MetroStation.objects.filter(city='–ú–æ—Å–∫–≤–∞').count()

    print(f"\nüìà –û–ë–©–ê–Ø –°–¢–ê–¢–ò–°–¢–ò–ö–ê:")
    print(f"üöá –ö–ª–∞—Å—Å–∏—á–µ—Å–∫–æ–µ –º–µ—Ç—Ä–æ: {classic_metro}/271")
    print(f"üîÑ –ú–¶–ö –∏ –ú–¶–î: {total_mcd_mck}")
    print(f"üéØ –í—Å–µ–≥–æ —Å—Ç–∞–Ω—Ü–∏–π: {total_all}")


# –ó–∞–ø—É—Å–∫ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –≤—Å–µ—Ö —Å—Ç–∞–Ω—Ü–∏–π
if __name__ == "__main__":
    print("üöá –ù–ê–ß–ò–ù–ê–ï–ú –î–û–ë–ê–í–õ–ï–ù–ò–ï –í–°–ï–• –°–¢–ê–ù–¶–ò–ô –ú–¶–ö –ò –ú–¶–î")
    print("=" * 60)

    total_added = 0
    total_added += add_mck_stations()
    total_added += add_mcd1_stations()
    total_added += add_mcd2_stations()
    total_added += add_mcd3_stations()
    total_added += add_mcd4_stations()

    print(f"\nüéâ –í–°–ï–ì–û –î–û–ë–ê–í–õ–ï–ù–û: {total_added} –°–¢–ê–ù–¶–ò–ô")
    show_final_stats()